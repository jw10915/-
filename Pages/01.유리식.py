import streamlit as st
import sympy as sp

# í˜ì´ì§€ ì„¤ì •
st.set_page_config(page_title="ìœ ë¦¬ì‹ (êµê³¼ì„œ ìŠ¤íƒ€ì¼)", layout="centered")

st.title("ğŸ“˜ ìœ ë¦¬ì‹")
st.write("---")

x = sp.Symbol('x')

# =========================
# 1. ìœ ë¦¬ì‹ì˜ ê°œë…
# =========================
st.header("1ï¸âƒ£ ìœ ë¦¬ì‹ì˜ ëœ»")

st.markdown("""
ë‹¤ìŒê³¼ ê°™ì´ **ë‘ ë‹¤í•­ì‹ì˜ ë‚˜ëˆ—ì…ˆìœ¼ë¡œ ë‚˜íƒ€ë‚¸ ì‹**ì„ **ìœ ë¦¬ì‹**ì´ë¼ê³  í•œë‹¤.

$$
\\frac{P(x)}{Q(x)} \\quad (Q(x) \\neq 0)
$$

ì´ë•Œ ë¶„ëª¨ì— ë¬¸ìê°€ í¬í•¨ëœ ì‹ë„ ìœ ë¦¬ì‹ì— í•´ë‹¹í•œë‹¤.
""")

# =========================
# ìœ ë¦¬ì‹ì˜ ì˜ˆ
# =========================
st.subheader("ğŸ“Œ ìœ ë¦¬ì‹ì˜ ì˜ˆ")

st.markdown("""
ë‹¤ìŒ ì‹ë“¤ì€ ëª¨ë‘ ìœ ë¦¬ì‹ì´ë‹¤.
""")

st.markdown("""
â‘  \\( \\frac{x}{x+1} \\)  

â‘¡ \\( \\frac{3}{x-2} \\)  

â‘¢ \\( \\frac{2x^2+1}{x^2-4} \\)
""")

st.markdown("""
ìœ„ ì‹ë“¤ì€ ëª¨ë‘ **ë¶„ëª¨ê°€ 0ì´ ë˜ì§€ ì•ŠëŠ” ë²”ìœ„ì—ì„œ ì •ì˜**ëœë‹¤.
""")

st.write("---")

# =========================
# 2. ìœ ë¦¬ì‹ì˜ ì—°ì‚°
# =========================
st.header("2ï¸âƒ£ ìœ ë¦¬ì‹ì˜ ì—°ì‚°")

operation = st.selectbox(
    "ì—°ì‚°ì„ ì„ íƒí•˜ì„¸ìš”",
    ["ë§ì…ˆ", "ëº„ì…ˆ", "ê³±ì…ˆ", "ë‚˜ëˆ—ì…ˆ"]
)

# ì˜ˆì œ ì‹ (êµê³¼ì„œ ìŠ¤íƒ€ì¼ ì˜ˆì œ)
examples = {
    "ë§ì…ˆ": ((x + 1)/(x - 2), (2*x)/(x + 3)),
    "ëº„ì…ˆ": ((2*x)/(x + 1), (x - 3)/(x - 2)),
    "ê³±ì…ˆ": ((x**2 - 1)/(x + 2), (x + 2)/(x + 1)),
    "ë‚˜ëˆ—ì…ˆ": ((x + 3)/(x - 1), (x + 1)/(x + 2)),
}

expr1, expr2 = examples[operation]

st.write("---")
st.subheader(f"ğŸ“– ì˜ˆì œ | ìœ ë¦¬ì‹ì˜ {operation}")

# =========================
# ë§ì…ˆ
# =========================
if operation == "ë§ì…ˆ":
    st.markdown("ë‹¤ìŒ ìœ ë¦¬ì‹ì„ ê³„ì‚°í•˜ì—¬ë¼.")
    st.latex(sp.latex(expr1) + " + " + sp.latex(expr2))

    st.markdown("""
**í’€ì´**

â‘  ë¶„ëª¨ê°€ ì„œë¡œ ë‹¤ë¥´ë¯€ë¡œ ê³µí†µë¶„ëª¨ë¥¼ êµ¬í•œë‹¤.  
ë¶„ëª¨ê°€ $(x-2)$, $(x+3)$ì´ë¯€ë¡œ ê³µí†µë¶„ëª¨ëŠ” $(x-2)(x+3)$ì´ë‹¤.
""")

    st.markdown("""
â‘¡ ê° ë¶„ìˆ˜ë¥¼ ê³µí†µë¶„ëª¨ì— ë§ê²Œ ê³ ì¹œë‹¤.
""")
    st.latex("\\frac{(x+1)(x+3) + 2x(x-2)}{(x-2)(x+3)}")

    st.markdown("""
â‘¢ ë¶„ìë¥¼ ì „ê°œí•˜ì—¬ ì •ë¦¬í•œë‹¤.
""")
    num = sp.expand((x+1)*(x+3) + 2*x*(x-2))
    st.latex("\\frac{" + sp.latex(num) + "}{(x-2)(x+3)}")

    st.markdown("""
â‘£ ì•½ë¶„í•˜ì—¬ ì •ë¦¬í•˜ë©´ ë‹¤ìŒê³¼ ê°™ë‹¤.
"
