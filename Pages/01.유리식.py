import streamlit as st
import sympy as sp

# í˜ì´ì§€ ì„¤ì •
st.set_page_config(page_title="ìœ ë¦¬ì‹ ì„œìˆ í˜• í’€ì´", layout="centered")

st.title("ğŸ“˜ ìœ ë¦¬ì‹ì˜ ê°œë…ê³¼ ì—°ì‚° (ì„œìˆ í˜• í’€ì´)")
st.write("---")

# ë³€ìˆ˜ ì„¤ì •
x = sp.Symbol('x')

# =====================
# 1. ìœ ë¦¬ì‹ì˜ ê°œë…
# =====================
st.header("1ï¸âƒ£ ìœ ë¦¬ì‹ì˜ ê°œë…")

st.markdown("""
**ìœ ë¦¬ì‹**ì´ë€ ë‘ ë‹¤í•­ì‹ì˜ ë‚˜ëˆ—ì…ˆìœ¼ë¡œ ë‚˜íƒ€ë‚¼ ìˆ˜ ìˆëŠ” ì‹ì„ ë§í•œë‹¤.  

ì¦‰,  
$$
\\frac{P(x)}{Q(x)} \\quad (Q(x) \\neq 0)
$$  
ì˜ ê¼´ë¡œ ë‚˜íƒ€ë‚¼ ìˆ˜ ìˆëŠ” ì‹ì´ë‹¤.

ì´ë•Œ ë¶„ëª¨ì— ë¬¸ìê°€ í¬í•¨ë˜ì–´ ìˆìœ¼ë©´ ì¼ë°˜ì ìœ¼ë¡œ ìœ ë¦¬ì‹ì´ë¼ í•œë‹¤.
""")

st.subheader("ğŸ“Œ ìœ ë¦¬ì‹ì˜ ì˜ˆì‹œ")
st.markdown("""
- \\( \\frac{x}{x+1} \\)  
- \\( \\frac{3}{x-2} \\)  
- \\( \\frac{2x^2+1}{x^2-4} \\)
""")

st.write("---")

# =====================
# 2. ìœ ë¦¬ì‹ì˜ ì—°ì‚°
# =====================
st.header("2ï¸âƒ£ ìœ ë¦¬ì‹ì˜ ì—°ì‚°")

operation = st.selectbox(
    "í•™ìŠµí•  ì—°ì‚°ì„ ì„ íƒí•˜ì„¸ìš”",
    ["ë§ì…ˆ", "ëº„ì…ˆ", "ê³±ì…ˆ", "ë‚˜ëˆ—ì…ˆ"]
)

# ì˜ˆì œ ì‹
examples = {
    "ë§ì…ˆ": ((x + 1)/(x - 2), (2*x)/(x + 3)),
    "ëº„ì…ˆ": ((2*x)/(x + 1), (x - 3)/(x - 2)),
    "ê³±ì…ˆ": ((x**2 - 1)/(x + 2), (x + 2)/(x + 1)),
    "ë‚˜ëˆ—ì…ˆ": ((x + 3)/(x - 1), (x + 1)/(x + 2)),
}

expr1, expr2 = examples[operation]

st.write("---")
st.header(f"ğŸ“– {operation} ì„œìˆ í˜• í’€ì´")

# =====================
# ë§ì…ˆ
# =====================
if operation == "ë§ì…ˆ":
    st.latex(sp.latex(expr1) + " + " + sp.latex(expr2))

    st.markdown("""
â‘  **ê³µí†µë¶„ëª¨ë¥¼ êµ¬í•œë‹¤.**

ë¶„ëª¨ê°€ ê°ê° $(x-2)$, $(x+3)$ì´ë¯€ë¡œ  
ê³µí†µë¶„ëª¨ëŠ” ë‘ ë¶„ëª¨ë¥¼ ê³±í•œ $(x-2)(x+3)$ì´ë‹¤.
""")
    st.latex("(x-2)(x+3)")

    st.markdown("""
â‘¡ **ê° ë¶„ìˆ˜ë¥¼ ê³µí†µë¶„ëª¨ì— ë§ê²Œ ê³ ì¹œë‹¤.**

ì²« ë²ˆì§¸ ë¶„ìˆ˜ì˜ ë¶„ìëŠ” $(x+3)$ì„ ê³±í•˜ê³ ,  
ë‘ ë²ˆì§¸ ë¶„ìˆ˜ì˜ ë¶„ìëŠ” $(x-2)$ë¥¼ ê³±í•œë‹¤.
""")
    st.latex("\\frac{(x+1)(x+3) + 2x(x-2)}{(x-2)(x+3)}")

    st.markdown("""
â‘¢ **ë¶„ìë¥¼ ì „ê°œí•˜ì—¬ ì •ë¦¬í•œë‹¤.**
""")
    numerator = sp.expand((x+1)*(x+3) + 2*x*(x-2))
    st.latex("\\frac{" + sp.latex(numerator) + "}{(x-2)(x+3)}")

    st.markdown("""
â‘£ **ì•½ë¶„ì´ ê°€ëŠ¥í•œì§€ í™•ì¸í•˜ê³  ìµœì¢… ì •ë¦¬í•œë‹¤.**
""")
    st.latex(sp.latex(sp.simplify(expr1 + expr2)))

# =====================
# ëº„ì…ˆ
# =====================
elif operation == "ëº„ì…ˆ":
    st.latex(sp.latex(expr1) + " - " + sp.latex(expr2))

    st.markdown("""
â‘  **ê³µí†µë¶„ëª¨ë¥¼ êµ¬í•œë‹¤.**

ë¶„ëª¨ê°€ $(x+1)$, $(x-2)$ì´ë¯€ë¡œ  
ê³µí†µë¶„ëª¨ëŠ” $(x+1)(x-2)$ì´ë‹¤.
""")

    st.markdown("""
â‘¡ **ê³µí†µë¶„ëª¨ë¡œ í†µë¶„í•˜ì—¬ ë¶„ìë¥¼ ê³„ì‚°í•œë‹¤.**
""")
    st.latex("\\frac{2x(x-2) - (x-3)(x+1)}{(x+1)(x-2)}")

    st.markdown("""
â‘¢ **ë¶„ìë¥¼ ì „ê°œí•˜ì—¬ ì •ë¦¬í•œë‹¤.**
""")
    numerator = sp.expand(2*x*(x-2) - (x-3)*(x+1))
    st.latex("\\frac{" + sp.latex(numerator) + "}{(x+1)(x-2)}")

    st.markdown("""
â‘£ **ì•½ë¶„ í›„ ìµœì¢… ê²°ê³¼ë¥¼ êµ¬í•œë‹¤.**
""")
    st.latex(sp.latex(sp.simplify(expr1 - expr2)))

# =====================
# ê³±ì…ˆ
# =====================
elif operation == "ê³±ì…ˆ":
    st.latex(sp.latex(expr1) + " \\times " + sp.latex(expr2))

    st.markdown("""
â‘  **ë¶„ìë¼ë¦¬, ë¶„ëª¨ë¼ë¦¬ ê³±í•œë‹¤.**
""")
    st.latex("\\frac{(x^2-1)(x+2)}{(x+2)(x+1)}")

    st.markdown("""
â‘¡ **ë¶„ìì™€ ë¶„ëª¨ë¥¼ ì¸ìˆ˜ë¶„í•´í•œë‹¤.**
""")
    st.latex("\\frac{(x-1)(x+1)(x+2)}{(x+2)(x+1)}")

    st.markdown("""
â‘¢ **ê³µí†µì¸ ì¸ìˆ˜ë¥¼ ì•½ë¶„í•œë‹¤.**
""")
    st.latex("x-1")

# =====================
# ë‚˜ëˆ—ì…ˆ
# =====================
elif operation == "ë‚˜ëˆ—ì…ˆ":
    st.latex(sp.latex(expr1) + " \\div " + sp.latex(expr2))

    st.markdown("""
â‘  **ë‚˜ëˆ„ëŠ” ìœ ë¦¬ì‹ì„ ë’¤ì§‘ì–´ ê³±ì…ˆìœ¼ë¡œ ë°”ê¾¼ë‹¤.**
""")
    st.latex("\\frac{x+3}{x-1} \\times \\frac{x+2}{x+1}")

    st.markdown("""
â‘¡ **ë¶„ìë¼ë¦¬, ë¶„ëª¨ë¼ë¦¬ ê³±í•œë‹¤.**
""")
    st.latex("\\frac{(x+3)(x+2)}{(x-1)(x+1)}")

    st.markdown("""
â‘¢ **ì •ë¦¬í•˜ì—¬ ìµœì¢… ê²°ê³¼ë¥¼ êµ¬í•œë‹¤.**
""")
    st.latex(sp.latex(sp.simplify(expr1 / expr2)))

st.write("---")
st.info("ğŸ’¡ ëª¨ë“  ê³„ì‚°ì—ì„œ ë¶„ëª¨ê°€ 0ì´ ë˜ëŠ” ê°’ì€ ì •ì˜ì—­ì—ì„œ ì œì™¸í•´ì•¼ í•œë‹¤.")
